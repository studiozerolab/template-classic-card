---
import { gallery } from "../config/site";
import { Image } from "astro:assets";

const importedImages = import.meta.glob("../assets/*.{jpg,jpeg,png,webp,svg}", {
  eager: true,
  import: "default",
});
const galleryImages = gallery.items.map((item) => ({
  alt: item.alt,
  src: importedImages[item.src] ?? item.src,
}));
---

<div class="max-w-6xl px-4 sm:px-6 lg:px-8">
  <header class="max-w-2xl mb-8">
    <h2 class="text-2xl sm:text-3xl font-bold mb-3">
      {gallery.heading}
    </h2>

    {gallery.intro && (
      <p class="text-base leading-relaxed text-[color:var(--color-text-muted)]">
        {gallery.intro}
      </p>
    )}
  </header>

  <div class="grid gap-5 sm:grid-cols-2 lg:grid-cols-3">
    {galleryImages.map((img) => (
      <figure
        class="
          rounded-xl
          overflow-hidden
          bg-[color:var(--color-surface)]
          border border-[color:var(--color-mid)]
          shadow-sm
        "
      >
        <div class="relative w-full aspect-[4/3]">
          <Image
            src={img.src}
            alt={img.alt}
            widths={[480, 768, 1024, 1400]}
            sizes="(min-width: 1024px) 33vw, (min-width: 640px) 50vw, 100vw"
            loading="lazy"
            decoding="async"
            class="absolute inset-0 w-full h-full object-cover"
        />
        </div>
      </figure>
    ))}
  </div>
</div>
